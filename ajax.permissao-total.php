<?php// Precisando de ajuda para desenvolver o seu sistema? acesse sistema-web-para.com.br e contrate uma assessoria...require_once('inc.verifica.php'); require_once('inc.iconnect.php');require_once('inc.funcoes.php');$_SESSION['permissao_total'][$_GET['id_pperfis']][$_GET['id_aacoes']] = $_GET['permissao'];$sql = 'UPDATE ppermissoes SET permissao = \''.ai($a, $_GET['permissao']).'\' WHERE id_pperfis = \''.ai($a, $_GET['id_pperfis']).'\' AND id_aacoes = \''.ai($a, $_GET['id_aacoes']).'\'';$res = log_mysqli_query($a, $sql);$sql = 'SELECT * FROM ppermissoes WHERE id_pperfis = \''.ai($a, $_GET['id_pperfis']).'\'';$res = mysqli_query_erro($a, $sql);while($ppermissoes = mysqli_fetch_array($res)){$id_ppermissoes[$ppermissoes['id_pperfis']][$ppermissoes['id_ttabelas']][$ppermissoes['id_ccampos']][$ppermissoes['id_aacoes']] = $ppermissoes['id'];$permissao_ppermissoes[$ppermissoes['id']] = $ppermissoes['permissao'];}$sql2 = 'SELECT * FROM aacoes ORDER BY id';$res2 = mysqli_query_erro($a, $sql2);while($aacoes = mysqli_fetch_array($res2)){?><span style="margin-right: 5px"><input type="checkbox" id="perfil_<?php echo $_GET['id_pperfis'] ?>acao_<?php echo $aacoes['id'] ?>" <?php if($_SESSION['permissao_total'][$_GET['id_pperfis']][$aacoes['id']] == 'Sim'){ ?>value="Não" checked <?php } else { ?>value="Sim" <?php } ?>onChange="permissao_total(<?php echo $_GET['id_pperfis'] ?>,<?php echo $aacoes['id'] ?>,this.value);"> <label for="perfil_<?php echo $_GET['id_pperfis'] ?>acao_<?php echo $aacoes['id'] ?>" style="font-weight:normal"><?php echo $aacoes['nome'] ?></label></span><?php}?><div class="panel-group" role="tablist" style="margin: 0px; margin-top: 5px;"><?php$sql = 'SELECT * FROM ttabelas';$res = mysqli_query_erro($a, $sql);while($ttabelas = mysqli_fetch_array($res)){?><div class="panel panel-default"><div class="panel-heading" role="tab" style="background-color: #ccc"><h4 class="panel-title"><i class="fa fa-th-large"></i> <?php echo $ttabelas['nome'] ?></h4></div><div class="panel-collapse collapse in" role="tabpanel" aria-labelledby="h2_<?php echo $ttabelas['id'] ?>"><div class="panel-body" id="tabela<?php echo $ttabelas['id'] ?>"> <?php$sql2 = 'SELECT * FROM aacoes ORDER BY id';$res2 = mysqli_query_erro($a, $sql2);while($aacoes = mysqli_fetch_array($res2)){$id = $id_ppermissoes[$_GET['id_pperfis']][$ttabelas['id']][0][$aacoes['id']];?><span style="margin-right: 5px"><input type="checkbox" id="perfil_<?php echo $_GET['id_pperfis'] ?>campo_<?php echo $id ?>" <?php if($permissao_ppermissoes[$id] == 'Sim'){ ?>value="Não" checked <?php } else { ?>value="Sim" <?php } ?>onChange="permissao_tabela(<?php echo $_GET['id_pperfis'] ?>,<?php echo $ttabelas['id'] ?>,<?php echo $aacoes['id'] ?>,this.value);"> <label for="perfil_<?php echo $_GET['id_pperfis'] ?>campo_<?php echo $id ?>" style="font-weight:normal"><?php echo $aacoes['nome'] ?></label></span><?php}?><div class="panel-group" role="tablist" style="margin: 0px; margin-top: 5px;"><?php$sql3 = 'SELECT * FROM ccampos WHERE id_ttabelas = \''.ai($a, $ttabelas['id']).'\'';$res3 = mysqli_query_erro($a, $sql3);while($ccampos = mysqli_fetch_array($res3)){?><div class="panel panel-default"><div class="panel-heading" role="tab" style="background-color: #eee"><h4 class="panel-title"><i class="fa fa-th-list"></i> <?php echo $ccampos['nome'] ?></h4></div><div class="panel-collapse collapse in" role="tabpanel" aria-labelledby="h3_<?php echo $ccampos['id'] ?>"><div class="panel-body"><?php$sql4 = 'SELECT * FROM aacoes ORDER BY id';$res4 = mysqli_query_erro($a, $sql4);while($aacoes = mysqli_fetch_array($res4)){$id = $id_ppermissoes[$_GET['id_pperfis']][$ttabelas['id']][$ccampos['id']][$aacoes['id']];?><span id="span<?php echo $id ?>" style="margin-right: 5px"><input type="checkbox" id="campo_<?php echo $id ?>" <?php if($permissao_ppermissoes[$id] == 'Sim'){ ?>value="Não" checked <?php } else { ?>value="Sim" <?php } ?>onChange="permissao_campo(<?php echo strip_tags($_GET['id_pperfis']); ?>,<?php echo $id ?>,'<?php echo urlencode($aacoes['nome']); ?>',this.value);" <?php if($aacoes['nome'] == 'Excluir'){ ?>disabled="disabled"<?php } ?>> <label for="campo_<?php echo $id ?>" style="font-weight:normal"><?php echo $aacoes['nome'] ?></label></span><?php}?></div></div></div><?php}?></div></div></div></div><?php}?></div>